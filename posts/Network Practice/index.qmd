---
title: "Hsp90 Proteome Network"
author: "Erick Rios"
---

```{r}
# Load required packages
library(igraph)

### Force directed graph of 350 proteins
stack <- read.csv("trimmed_proteomic_Data.csv")

nodes <- unique(c(stack$contrast, stack$Gene))
edges <- data.frame(
  from = stack$Gene,
  to = stack$contrast,
  LogFC = stack$logFC,
  p = stack$P.Value
  
)

g <- graph_from_data_frame(edges, directed = FALSE, vertices = nodes)

edge_weights <- abs(E(g)$LogFC)^3
E(g)$length <- edge_weights

l <- layout_with_fr(g, weights = edge_weights)

default_size <- 4

vertex_sizes <- rep(default_size, vcount(g))

mutants <- c("A583T","G309S", "G424D",
             "K102E", "Q380K", "R46G", 
             "S25P", "S481Y", "W296A")

vertex_sizes[V(g)$name %in% mutants] <- 8

V(g)$label.color <- "black"
V(g)$label.font <- 2

plot(g, layout = l, vertex.color = "white", vertex.size = vertex_sizes,
     vertex.label.cex = .25, edge.width = -log10(E(g)$p)*.2, edge.arrow.size = 0, frame.plot = T,  main = "350")

###
```
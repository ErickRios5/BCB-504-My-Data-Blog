{
  "hash": "bd902e31d1ac0a6899980605a1aee42f",
  "result": {
    "markdown": "---\ntitle: \"BCB 520 - The Final Project\"\nsubtitle: \"Mutations in Molecular Chaperone: Hsp90 Elicit Different Proteomic Responses\"\nformat:\n  html:\n    toc: false\n    echo: true\nauthor: \"Erick Rios\"\ndate: \"2023-05-03\"\ncategories: [Portfolio, DataViz, Network, Project, Hsp90, Mutations]\nimage: \"yeastbud.png\"\ndescription: \"Network visualization and analysis of proteomic responses to Hsp90 mutation.\"\ncode-fold: true\ncode-tools: true\nbibliography: references.bib\n---\n\n\n# The Preamble\n\nThe focus of my research is the study of Hsp90 molecular chaperone. Over the decades we come to realize this chaperone sits as a major hub of protein-protein interactions [@Gopinath2014; @Zhao2005a; @Rizzolo2019] in which it regulates the folding, activity, and degradation of its clients.\n\nThe current study expands the preliminary proteomic analysis previously done in yeast by us[@Hohrman2021], here we use quantitative proteomic analysis to compare extracts from yeast expressing wild-type yeast Hsp90 to nine different mutants. Our results demonstrate that the mutants elicit varied proteomic responses, even though the cells were harvested at temperatures that do not significantly affect growth. Overall, our results suggest:\n\n1.  It is possible to selectively inhibit Hsp90 function *in vivo*, and\n\n2.  Identifies **cellular processes** and/or likely **clients** that may be differentially affected by Hsc82 mutation.\n\n# Data\n\nData source:\n\n1.  Main data used in this analysis are the results of Data Independent Acquisition Mass Spectrometry (DIA-MS) experiments, a technique for quantitative proteomics. This is the crux of our study. For brevity, the data has been pre-filtered for significant hits of interest for analysis.\n\nA significant hit in our study is a protein whose abundance had a \\|Log~2~ Fold Change\\| (LogFC) greater than 1.5, relative to wild-type.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load in our data\nproteomic <- read.csv(\"trimmed_proteomic_Data.csv\")\n```\n:::\n\n\nData Dictionary #1\n\n\n::: {.cell}\n\n:::\n\n\n2.  Supporting data/information publicly available on *Saccharomyces Genome Database ([SGD](https://yeastgenome.org/ \"Saccharomyces Genome Database main page\"))*\n\n-   List of currently known protein **physical** interactors of Hsp90 (Both [Hsc82](https://yeastgenome.org/locus/S000004798/interaction \"List of Hsc82 genetic and physical interactors\") and [Hsp82](https://yeastgenome.org/locus/S000006161/interaction \"List of Hsp82 genetic and physical interactors\") isoforms)\n-   List of currently known protein **genetic** interactors of Hsp90 (Both [Hsc82](https://yeastgenome.org/locus/S000004798/interaction \"List of Hsc82 genetic and physical interactors\") and [Hsp82](https://yeastgenome.org/locus/S000006161/interaction \"List of Hsp82 genetic and physical interactors\") isoforms)\n-   Hits from our data analyzed by [Gene Ontology (GO) Slim Mapper](https://yeastgenome.org/goSlimMapper \"Gene Ontology tool to classify and group genes/proteins\") \\# Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use read.table() to read in the file\n# Hsp90.Interactors <- read.table(file_path, header = TRUE, sep = \"\\t\", stringsAsFactors = FALSE)\n```\n:::\n\n\nData Dictionary #2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGO.terms <- read.table(file = \"GO Slim Mapper Results.txt\", header = TRUE, sep = \"\\t\", stringsAsFactors = FALSE)\n```\n:::\n\n\nData Dictionary #3\n\n\n::: {.cell}\n\n:::\n\n\n# Visualizations\n## Figure 1: Hsp90 Mutant-Protein Network of Significant Hits\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\n```\n:::\n\n\n### NODES\n\nSince our objective is to construct a protein interaction network, intuitively our nodes will be our significant hits found in our study. However, we must also include our experimental variables, in this case single point mutations in the Hsp90 chaperone, this will help promote separation/clustering between nodes later when we apply our measurements from DIA-MS.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize 350 nodes corresponding to the significant hits in our data\nnodes <- unique(c(proteomic$contrast, proteomic$Gene))\n\ng <- make_empty_graph(directed = FALSE)\ng <- add_vertices(g, length(nodes))\nV(g)$name <- nodes\n\nplot(g, \n     margin = -.4,\n     vertex.size = 4,\n     vertex.label.cex = .5,\n     xlim=c(-1.5, 1.5), ylim=c(-1.5,1.5) \n     )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\nIn this circle of nodes we have our 9 Hsp90 mutants and 350 proteins that had a significant change in protein abundance in at least one mutant strain.\n\n### EDGES\n\nNow we must establish the relationship between these nodes. Starting with the relationship between our protein hits and experimental variables (Hsp90 mutants). These proteins were found to have a significant change in abundance when at least one mutant Hsp90 is expressed as the sole source of Hsp90.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedges <- data.frame(\n  from = proteomic$Gene,\n  to = proteomic$contrast,\n  LogFC = proteomic$logFC,\n  p = proteomic$P.Value\n  \n)\n\n# Convert edge list to indices\nedges$from <- match(edges$from, nodes)\nedges$to <- match(edges$to, nodes)\n\n# create a list of alternating values from 'from' and 'to' columns\nedge_list <- c(rbind(edges$from, edges$to))\n\ng <- add_edges(g, edges = edge_list)\n\n# Specify edge length based on attribute: LogFC\n\nedge_weights <- abs(edges$LogFC)\nE(g)$weight <- edge_weights\n```\n:::\n\n\n### Default Network\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot the network\nplot(g)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nNice, we now have the results of our DIA-MS experiments for each mutant 'condition' visualized as a network. However, I think it is safe to say it is garbage and unintelligible as-is. Let's make some conscious design choices to make this at least visually pleasing to the eye. Bonus points if it reveals something cool!\n\n### Make it pretty \n\n::: {.cell}\n\n```{.r .cell-code}\n# Nodes\nnodes <- unique(c(proteomic$contrast, proteomic$Gene))\n\ng <- make_empty_graph(directed = FALSE)\ng <- add_vertices(g, length(nodes))\n\n# set all vertex labels to an empty string\nV(g)$label <- \"\"\n\n# manually assign labels to the 9 (mutant) nodes\nV(g)$label[1:9] <- nodes[1:9]\n\n# node colors\n\nV(g)$color <- \"white\"\n\n# Hide the mutant node shapes\nV(g)$size <- 3\nV(g)[1:9]$size <- 5\n\n# Hide mutant nodes, but leave labels\nV(g)$shape <- \"circle\"\nV(g)$shape[1:9] <- \"none\"\n\n# Edges\nedges <- data.frame(\n  from = proteomic$Gene,\n  to = proteomic$contrast,\n  LogFC = proteomic$logFC,\n  p = proteomic$P.Value\n  \n)\n\n# Convert edge list to indices\nedges$from <- match(edges$from, nodes)\nedges$to <- match(edges$to, nodes)\n\n# create a list of alternating values from 'from' and 'to' columns\nedge_list <- c(rbind(edges$from, edges$to))\n\ng <- add_edges(g, edges = edge_list)\n\n# Specify edge length based on attribute: LogFC\n# \"Undo\" the Log (base: 2) so that larger LogFC values have more 'weight'\n# add 10 to all values to help make the network physically smaller.\n\nedge_weights <- abs(edges$LogFC)\nE(g)$weight <- edge_weights\n\n# c <- cluster_louvain(g, resolution = 1.25)\n\nlayout <- layout_with_fr(g)\n\n# Plot the network\nset.seed(420)\nplot(g,\n     layout = layout,\n     margin = -.8, # allow the network to use up more of the margin\n     vertex.label.cex = .5,\n     vertex.label.font = 2, # Bold\n     vertex.label.color = \"black\",\n     edge_arrow_mode = 0,\n     xlim=c(-1.75, 1.75), ylim=c(-1.75, 1.75) # Increase the plot size to help accommodate the network\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nDesign choices: We are more interested in results as a whole and not individual proteins (for now at least), node size was decreased and labels removed; To help distinguish between the 2 node classes/groups: Hsp90 mutations and Proteins, the mutant node shapes were removed, leaving behind the label.\n\n## Integrate Hsp90 Interactor data and results from Gene Ontology.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tidyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:igraph':\n\n    crossing\n```\n:::\n\n```{.r .cell-code}\n# Create an example data frame\ndf <- data.frame(group = c(1, 2, 3),\n                 members = c(\"A, B, C\", \"D, E, F\", \"G, H\"))\n\n# Separate the comma-separated values in the \"members\" column into separate rows\ndf_split <- separate_rows(df, members, sep = \", \")\n\n# View the resulting data frame\ndf_split\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 x 2\n  group members\n  <dbl> <chr>  \n1     1 A      \n2     1 B      \n3     1 C      \n4     2 D      \n5     2 E      \n6     2 F      \n7     3 G      \n8     3 H      \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# all vertex shapes, minus \"raster\", that might not be available\nshapes <- setdiff(shapes(), \"\")\ng <- make_ring(length(shapes))\nset.seed(42)\nplot(g, vertex.shape=shapes, vertex.label=shapes, vertex.label.dist=1,\n     vertex.size=15, vertex.size2=15,\n     vertex.pie=lapply(shapes, function(x) if (x==\"pie\") 2:6 else 0),\n     vertex.pie.color=list(heat.colors(5)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# add new vertex shape, plot nothing with no clipping\nadd_shape(\"nil\")\nplot(g, vertex.shape=\"nil\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a sample data frame with 9 sets of measurements\nset.seed(123)\ndf <- data.frame(cond1 = rnorm(10), cond2 = rnorm(10), cond3 = rnorm(10),\n                 cond4 = rnorm(10), cond5 = rnorm(10), cond6 = rnorm(10),\n                 cond7 = rnorm(10), cond8 = rnorm(10), cond9 = rnorm(10))\n\n# calculate the correlation matrix between all pairs of conditions\ncor_matrix <- cor(df)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\n\nset.seed(1234)\n\n# create a random igraph network\ng <- erdos.renyi.game(10, 0.2)\n\n# assign a group number to each node\nV(g)$group <- sample(1:3, 10, replace=TRUE)\n\n# plot the igraph network with the group annotation\nplot(g, vertex.color=V(g)$group, vertex.size=20, vertex.label=NA, \n     main=\"Igraph network with group annotation\")\nlegend(\"topleft\", legend=unique(V(g)$group), fill=unique(V(g)$group))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\n\nset.seed(1234)\n\n# create a random igraph network\ng <- erdos.renyi.game(10, 0.2)\n\n# assign a group number to each node\nV(g)$group <- sample(1:3, 10, replace=TRUE)\n\n# detect communities using Louvain algorithm\nc <- cluster_louvain(g)\n\n# plot the igraph network with group annotation and cluster highlighting\nplot(c, g, vertex.color=V(g)$group, vertex.size=20, vertex.label=NA, \n     mark.groups=TRUE, mark.border=2, main=\"Igraph network with group and cluster annotation\")\nlegend(\"topleft\", legend=unique(V(g)$group), fill=unique(V(g)$group))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Create an example graph with groups assigned to nodes\n# g <- graph_from_data_frame(data.frame(from = sample(1:10, 20, replace = TRUE), \n#                                       to = sample(1:10, 20, replace = TRUE)))\n# V(g)$group <- sample(1:3, 10, replace = TRUE)\n# \n# # Set colors for the groups\n# group_colors <- c(\"red\", \"green\", \"blue\")\n# \n# # Assign initial coordinates to nodes in a circle\n# coords <- layout_in_circle(g)\n# \n# # Apply Kamada-Kawai layout to cluster nodes by group\n# layout <- layout_with_kk(g, initial = coords, \n#                          dim = 2, \n#                          niter = 1000,\n#                          user.weights = V(g)$group,\n#                          weight.exp = 1)\n# \n# # Plot the graph with clustered nodes and group annotations\n# plot(g, \n#      layout = layout, \n#      vertex.color = group_colors[V(g)$group],\n#      vertex.label.color = \"black\", \n#      vertex.label.family = \"sans\", \n#      vertex.label.cex = 1, \n#      vertex.size = 20, \n#      margin = -0.5, \n#      vertex.shape = \"circle\",\n#      edge.color = \"gray\")\n# \n# # Add group annotations\n# for (group in unique(V(g)$group)) {\n#   members <- V(g)$name[V(g)$group == group]\n#   x <- mean(layout[V(g)$name %in% members, 1])\n#   y <- mean(layout[V(g)$name %in% members, 2])\n#   text(x, y, paste0(\"Group \", group), col = group_colors[group], font = 2, cex = 2)\n# }\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\n\n# Create an empty graph with 10 nodes arranged in a ring\ng <- make_empty_graph(10)\ng <- add_edges(g, c(1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,1))\n\n# Set initial layout\nlayout <- layout_with_fr(g)\n\n# Set coordinates for the first 9 nodes in a ring formation\nfixed_coords <- cbind(cos(seq(0, 7/4*pi, length.out=9)), sin(seq(0, 7/4*pi, length.out=9)))\nfixed_coords <- rbind(fixed_coords, c(0,0))  # add coordinate for 10th node\n\n# Set fixed nodes in layout matrix\nlayout[1:10,] <- fixed_coords\n\n# Plot the graph with fixed positions for the first 9 nodes\nplot(g, layout = layout)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a sample graph\ng <- sample_gnm(10, 15)\n\n# Set the weight of all edges to 0.5\nE(g)$weight <- 0.5\n\n# Set the weight of edges between nodes with no edges between them to 0\nno_edges <- which(degree(g) == 0)\nfor (i in no_edges) {\n  for (j in no_edges) {\n    if (i < j) {\n      E(g)[i, j]$weight <- 5\n    }\n  }\n}\n\n# Calculate the layout with the modified weights\nlayout <- layout_with_fr(g, weights = E(g)$weight)\n\nplot(g)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n# Conlusions\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}